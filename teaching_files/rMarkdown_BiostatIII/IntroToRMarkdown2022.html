<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Intro to R Markdown</title>
    <meta charset="utf-8" />
    <meta name="author" content="Elsa Fogelström, elsa.fogelstrom@gmail.com" />
    <meta name="date" content="2022-12-05" />
    <meta name="keywords" content="r, markdown" />
    <script src="libs/header-attrs-2.18/header-attrs.js"></script>
    <link rel="stylesheet" href="presentation_EF.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Intro to R Markdown
]
.subtitle[
## Biological statistics III
]
.author[
### Elsa Fogelström, <a href="mailto:elsa.fogelstrom@gmail.com" class="email">elsa.fogelstrom@gmail.com</a>
]
.date[
### 5 December 2022
]

---

name: slide
class: spaced 


















## Today's session

Learn the basics of making a report using R Markdown  

Produce neat, reproducible reports directly from your code  

&lt;br&gt;
&lt;br&gt;

--
  
**Reproducibility &amp; repeatability**  

--

* Code, notes and output in one document   






&lt;br&gt;
&lt;br&gt;


&lt;br&gt;
&lt;br&gt;


.small[More on repeatability and reproducibility [here](https://www.technologynetworks.com/informatics/articles/repeatability-vs-reproducibility-317157) and [here](https://www.labmate-online.com/news/news-and-views/5/breaking-news/what-is-the-difference-between-repeatability-and-reproducibility/30638)]

---
name: slide
class: left, inverse, spaced 

.pull-right-40[.pull-right-30[
![an image](images/rmarkdownLogo.png) ]

&lt;br&gt;  
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

![an image](https://d33wubrfki0l68.cloudfront.net/6d2d611d3fd21938c75b12adc3f3c144f0cc7559/80071/images/bandthree2.png) 
.vsmall[https://rmarkdown.rstudio.com/]]

## R Markdown 

**R**, a free software environment for statistical computing and graphics/programming language for statistical computing  
**markdown**, a lightweight markup language for creating formatted text

--

Save and execute R code



--


Add text with simple formatting to produce  
* Documents (reports, manuscripts ...)
* Presentations  
* Web pages
* Books

directly from your code and data


---
name: slide
class: spaced

## Prerequisites


&lt;br&gt;  

An editor, e.g. [RStudio](https://www.rstudio.com/products/rstudio/download/), to create and edit R Markdown document  


&lt;br&gt;  

.pull-left-40[The `rmarkdown` package  

&lt;br&gt;

LaTeX, e.g. [TinyTeX](https://yihui.name/tinytex/), to produce PDF documents

&lt;br&gt;

Installing `tidyverse` will install both RMarkdown and TinyTeX. Tidyverse contains many useful packages for data management and visualization.]





.pull-right-50[
```
install.packages("rmarkdown", 
dependencies = TRUE)
```

```
install.packages("tinytex")
tinytex::install_tinytex()
```
&lt;br&gt;
```
install.packages("tidyverse", 
dependencies = TRUE)
```
]


---
name: slide
class: spaced

## Creating an R Markdown document  


.pull-left-50[
&lt;br&gt;
![an image](images/NewNotebook.png)
Create an basic .Rmd document  

.rmd documents are displayed in "notebook-mode" per default

]

--

.pull-right-50[
&lt;br&gt;
![an image](images/NewMarkdown.png)  
Create .Rmd documents, presentations and more 
]

---
name: slide
class:spaced

## Creating an R Markdown document  

![an image](images/NotebookTemplate.png)

---
name: slide
class:spaced

## Previewing an R Markdown document  

![an image](images/PreviewNotebookTemplate.png)

---
name: slide
class:spaced

## Previewing an R Markdown document  

![an image](images/PreviewNotebookTemplate2.png)


---
name: slide
class:spaced

##R Markdown (.rmd) document components  

.pull-left-40[
&lt;br&gt;

###Metadata  

&lt;br&gt;

###Text  

&lt;br&gt;

###Code chunks]

.pull-right-40[![an image](images/NotebookComponents.png)]


---
name: slide
class:left, inverse. spaced

## Metadata  

.pull-right-40[![an image](images/YAMLdefault.png)]  

--

.pull-left-50[Document specific settings (author, date, output format ...)  


Separated with 3 dashes (`---`)]  

--

.pull-left-50[Syntax = YAML  


Often referred to as "YAML metadata", "YAML header", "YAML frontmatter" ...


]

---
name: slide
class:spaced, left, inverse

## Editing metadata

Title, author(s), date  

&lt;br&gt;  
  
&lt;br&gt;  

![an image](images/YAMLedited.png)

---
name: slide
class: left, inverse, spaced

## Editing metadata

Output options (doesn't cover all output formats):  

.pull-left-50[![an image](images/OutputOptionsDropdown.png)]

--

.pull-right-40[![an image](images/OutputOptionsGeneral.png)]

---
name: slide
class: left, inverse, spaced

## Editing metadata

.pull-left-50[Output formats  

`github_document`  
`html_document`  
`latex_document`  
`md_document`  
`odt_document`  
`pdf_document`  
`word_document`  

`beamer_presentation`  
`ioslides_presentation`  
`powerpoint_presentation`  
`rtf_document`  
`slidy_presentation` 

and more from templates
]
.pull-right-40[![an image](images/YAMLedited.png)]

---
name: slide
class:left, spaced

## Text

**Markdown**, a simple formatting language ([official website](https://daringfireball.net/projects/markdown/))


Plain text with simple formatting  

--

Other laguages are also supported (e.g. HTML, LaTeX ...) 

---
name: slide
class:spaced

## Text formatting

--

To make sure that a line break is made, **use double space**  
--


.pull-left-50[
`*italics*`  
`**bold**`  
&lt;br&gt;  
` # header1`  

`## header2`  

`### header3`  


]

.pull-right-50[
&lt;i&gt;italics&lt;/i&gt;  
&lt;b&gt;bold&lt;/b&gt;
&lt;br&gt;  

#header1

##header2  

###header3  
]  



---
name: slide
class:left, inverse, spaced

## Text formatting: Lists  


.pull-left-50[
`* this is`  
`* a list`  
&lt;br&gt;  
`- this is`  
`- another list`  
&lt;br&gt;  
`1. this is a`  
`2. numbered list`  

&lt;br&gt;
&lt;br&gt;
.pull-center[**remember double space** ] ]

.pull-right-50[
* this is    
* a list  
&lt;br&gt;  
- this is  
- another list  

&lt;br&gt;  
1. this is a  
2. numbered list  

] 
&lt;br&gt; 



---
name: slide
class:spaced

## Text formatting: Mathematical annotation (LaTeX)

.pull-left-60[
inline mathematical annotation:  
```
Eqn. 1: $\frac{x}{x^2}$
```
&lt;br&gt;  
centered mathematical annotation:  
```
$$Y \tilde~\beta_0~+~\beta_1*x~+~\epsilon$$ 
```
]

.pull-right-40[&lt;br&gt;
Eqn. 1: `\(\frac{x}{x^2}\)`  

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

`$$Y \tilde~\beta_0~+~\beta_1*x~+~\epsilon$$`]


---
name: slide
class: spaced


![an image](images/FormattedText.png)


---
name: slide
class: spaced

## Code 

Code is included in *chunks* separated by three backticks

![an image](images/AChunk.png)


---
name: slide
class: left, inverse, spaced

## Code 

.pull-left-40[
&lt;br&gt;
Code is included in *chunks* separated by three backticks (``` ``` ```)  
&lt;br&gt;
"insert"/"R"  

&lt;br&gt;

keyboard shortcuts:  
*Ctrl+Alt+i*  
*Cmd+Option+i*]


.pull-right-50[

![an image](images/AChunk.png)

![an image](images/InsertChunk2.png)
]

--




---
name: slide
class: spaced

##Code  

**Run a chunk** (execute code)

.pull-left-50[   

- click "Run" and select an option from the list  

- click the the play symbol in the chunk corner  

- place cursor within the chunk and press *Ctrl/Cmd+Shift+Enter*  

- run one or more rows: Place the cursor in (or mark) the code you want to run and press *Ctrl/Cmd + Enter*  

[More keyboard shortcuts](https://support.rstudio.com/hc/en-us/articles/200711853-Keyboard-Shortcuts) 
]



.pull-right-40[![an image](images/RunChunkDropdown.png)]
.pull-right-50[![an image](images/RunChunkPlay.png)]




---
name: slide

##Code

![an image](images/RunChunkOutput.png)

---
name: slide
class: middle, inverse, spaced

.center[##More formatting]

---
name: slide
class: left, inverse, spaced


##Knitr options

![an image](images/AChunk_KnitrOptions.png)

--

###Show/hide code and output

.pull-left-70[

Hide code: `{r echo=FALSE}`  

Hide code and output: `{r include=FALSE}`  

Don't run chunk: `{r eval=FALSE}`  

]



---
name: slide
class: left, inverse, spaced


##Knitr options  

###Figure size/position


Figure size: `{r fig.width = 3, fig.height = 4}`  

Figure position: `{r fig.align = 'default'}`  
Options: `'left', 'right', 'center' `

&lt;br&gt;

###supress messages and warnings  

`{r warning=FALSE,message=FALSE}`



---
name: slide
class: left, inverse, spaced


##Knitr options 

### Set knitr options for the entire document

using `knitr::opts_chunk$set()` within an R code chunk: 


```r
knitr::opts_chunk$set(echo = FALSE, # hide code
                      # align figues left
                      # (does not work with word):
                      fig.align = "left")
```


---
name: slide
class: left, inverse, spaced


## Make a table using the `kable` function

&lt;br&gt;


```r
# library (knitr)
# specify a model:
mod &lt;- lm(Petal.Length ~ Species, data =iris)

# present model output as table
knitr::kable(summary(mod)$coefficients, digits=3, format = 'html')
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Std. Error &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; t value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Pr(&amp;gt;|t|) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; (Intercept) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.462 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.061 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24.023 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Speciesversicolor &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.798 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.086 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.510 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Speciesvirginica &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.090 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.086 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.521 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;br&gt;
&lt;br&gt;


Works for .html and .pdf documents. Does not work for making .docx documents. 
`format` needs to be set to `format = 'latex'` when knitting to pdf

---
name: slide
class: left, inverse, spaced

## Make a table using the `pander` function





```r
library(pander)
panderOptions('round', 3) 
pander(mod)
```
&lt;br&gt;

I use it a lot for making tables for word documents. Works for .pdf and .html documents too. Did not work well in this .htlm presentation. 

&lt;br&gt;

Examples and formatting options can be found [here](https://rdrr.io/cran/pander/f/vignettes/pandoc_table.Rmd) and [here](https://www.rdocumentation.org/packages/pander/versions/0.6.3/topics/panderOptions) 

---
name: slide
class: left, inverse, spaced

##Combine text and code  

###Inline code 

.pull-left-60[ 
**If not to be executed:** surrounded with single backticks (\`)  


&lt;br&gt;
**code to be executed** is surrounded by a single backtick and starts with a small 'r'


There are `` `r `` `` nrow(iris)` `` entries in the iris dataset
]

.pull-right-30[
&lt;br&gt;

`Inline` code  
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
There are 150 entries in the iris dataset]


---
class: left, inverse, spaced

##Images    

.pull-left-50[Within an r-chunk:

```
knitr::include_graphics(
'Iris_virginica.jpg')
```
&lt;br&gt;

In markdown (text):
```
![an image](Iris_virginica.jpg)
```

&lt;br&gt;

.small[Both methods work with either path to local file or URL to an online file.  

Here are some [Tips and tricks for working with images and figures in R Markdown documents](http://www.zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/#bonus-knitr-and-r-markdown-functionality)] ]



.pull-right-30[
&lt;img src="images/Iris_virginica.jpg" style="display: block; margin: auto auto auto 0;" /&gt;

![figure caption or title](images/Iris_virginica.jpg)

]

---
class: left, inverse, spaced

## Embedded links

Add the description within brackets and the URL within parentheses:

`[Iris versicolor](http://www.florafinder.com/LargePhotos/D9/Iris_versicolor-81C439DB39.jpg)
`

&lt;br&gt;

It will end up looking something like this in the output document:

[Iris versicolor](http://www.florafinder.com/LargePhotos/D9/Iris_versicolor-81C439DB39.jpg)


---
class: left, inverse, spaced

##Rendering ('knitting') files  

Render: the process of producing an output file from your .Rmd file   

**knitr** executes code and saves your output to a markdown (.md) document  

**pandoc** converts the markdown document to format of your choice

![image render process](https://d33wubrfki0l68.cloudfront.net/61d189fd9cdf955058415d3e1b28dd60e1bd7c9b/b739c/lesson-images/rmarkdownflow.png)
.vsmall[https://d33wubrfki0l68.cloudfront.net/61d189fd9cdf955058415d3e1b28dd60e1bd7c9b/b739c/lesson-images/rmarkdownflow.png]

use `render` function or simply click *knit* (in drop-down menu next to *Preview* button)

---
name: slide
class: left, inverse, spaced

## Render document: HTML 

![an image](images/RenderHTML.png)

---
name: slide
class: left, inverse, spaced

## Render document: HTML 

![an image](images/RenderHTML2.png)

---
name: slide
class: left, inverse, spaced

## Render document: PDF  

![an image](images/RenderPDF.png)
---
name: slide
class: left, inverse, spaced

## Render document: PDF 

![an image](images/RenderPDF.png)

---
name: slide
class: left, inverse, spaced

## Render document: .docx 

![an image](images/RenderDocx.png)

---
name: slide
class: left, inverse, spaced

## Render document
![an image](images/RenderingProcess.png)


---
names: slide
class: left, inverse, spaced

## Try it for yourselves!

1. Create a new .Rmd file  

2. Play around with as much formatting as possible:  

  * edit the YAML metadata  
  * headers 
  * &lt;b&gt;bold&lt;/b&gt;, &lt;i&gt;italics&lt;/i&gt;, lists
  * inline code  
  * figures from data (using your own data or the `iris` dataset)  
  * mathematical annotation  
  * visible/hidden r code
  * ...  

3. Click the *Preview* button to see how it turned out

4. Render your report to different document formats


---
class: left, inverse, spaced

##If you run into problems

--

###Is everything in the right place?  

Within/outside code chunks? 


###Error message:
Search online! You're probably not the first to get that error message


### Best practices and solutions to common problems:

https://rmd4sci.njtierney.com/common-problems-with-rmarkdown-and-some-solutions.html
---
class: left, inverse, spaced


##Problems with LaTex and knitting to .pdf

###TinyTex  

Error message when installing on mac:
https://github.com/yihui/tinytex/issues/24

Update or reinstall TinyTex https://yihui.name/tinytex/r/#debugging
 

If TinyTex doesn't work, try using [texworks](http://www.tug.org/texworks/)

&lt;br&gt;

###Knitting to pdf: Error messages  

- Try to figure out problem from message  
   - code chunk that doesn't run?
   - weird symbols?
  
- File/Save with encoding/UTF-8

- Change LaTeX engine to 'xelatex' (output options/advanced)

- Ask Google  



---
class: left, inverse, spaced


* This is an R Markdown presentation. 
* Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents.
* This presentation was created in RStudio using [`remarkjs`](https://github.com/gnab/remark) framework through R package [`xaringan`](https://github.com/yihui/xaringan).
* This template uses custom CSS style.
* For R Markdown, see &lt;http://rmarkdown.rstudio.com&gt;
* For R Markdown presentations, see &lt;https://rmarkdown.rstudio.com/lesson-11.html&gt;

##  


---
name: slide
class: spaced 

##References/tutorials

[R Markdown cheat sheet](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf)

[Introduction to R Markdown (RStudio)](https://rmarkdown.rstudio.com/lesson-1.html)

[*R Markdown: The Definitive Guide* (Yihui Xie, J. J. Allaire, Garrett Grolemund)](https://bookdown.org/yihui/rmarkdown/)

[Knitr output options (Yihui Xie)](https://yihui.name/knitr/options/)



---
names: slide
class: left, inverse, spaced

## Try it for yourselves!

1. Create a new .Rmd file  

2. Play around with as much formatting as possible:  

  * edit the YAML metadata  
  * headers 
  * &lt;b&gt;bold&lt;/b&gt;, &lt;i&gt;italics&lt;/i&gt;, lists
  * inline code  
  * figures from data (using your own data or the `iris` dataset)  
  * mathematical annotation  
  * visible/hidden r code
  * ...  

3. Click the *Preview* button to see how it turned out

4. Render your report to different document formats



---
name: end-slide
class: end-slide

# Thank you
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "4:3",
"highlightLanguage": "r",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
